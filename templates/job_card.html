<div class="job-card"
     data-score="{{ job.fit_score or 0 }}"
     data-status="{{ job.status or 'new' }}"
     data-remote="{{ 'true' if job.remote else 'false' }}"
     data-source="{{ job.source or 'unknown' }}"
     data-text="{{ (job.title ~ ' ' ~ job.company)|lower }}">
    
    <!-- Header with Score Badge -->
    <div class="job-header">
        <div class="job-header-content">
            <div class="job-title">{{ job.title }}</div>
            <div class="job-company">ğŸ¢ {{ job.company }}</div>
        </div>
        <div class="score-badge {% if job.fit_score >= 70 %}score-high{% elif job.fit_score >= 60 %}score-mid{% else %}score-low{% endif %}">
            {{ "%.0f"|format(job.fit_score or 0) }}%
        </div>
    </div>

    <!-- Quick Meta Info -->
    <div class="job-meta">
        <span class="meta-item">ğŸ“ {{ job.location or 'Remote' }}</span>
        {% if job.remote %}<span class="meta-item">ğŸ  Remote</span>{% endif %}
        <span class="meta-item">ğŸ”— {{ job.source or 'unknown' }}</span>
        {% if job.posted_date %}<span class="meta-item">ğŸ“… {{ job.posted_date }}</span>{% endif %}
    </div>

    <!-- Skills & Tags -->
    <div class="tags">
        {% if job.role_matches %}
            <span class="chip chip-role">{{ job.role_matches[0] }}</span>
        {% endif %}
        {% if job.tech_matches %}
            {% for tech in job.tech_matches[:4] %}
                <span class="chip chip-tech">{{ tech }}</span>
            {% endfor %}
        {% endif %}
        {% if job.industry_matches %}
            <span class="chip chip-industry">{{ job.industry_matches[0] }}</span>
        {% endif %}
    </div>

    <!-- Reasoning (Why it matches) -->
    <div class="job-reasoning">
        <div class="reasoning-label">Why it matches:</div>
        {{ (job.reasoning or 'This role matches your skills and industry preferences.')[:200] }}{% if (job.reasoning or '')|length > 200 %}â€¦{% endif %}
    </div>

    <!-- Actions -->
    <div class="job-actions">
        <a href="{{ job.url }}" 
           target="_blank" 
           class="btn btn-primary btn-small apply-link"
           data-job-id="{{ job.id }}"
           data-company="{{ job.company }}">
            <span>Apply on {{ job.source or 'site' }}</span>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                <polyline points="15 3 21 3 21 9"></polyline>
                <line x1="10" y1="14" x2="21" y2="3"></line>
            </svg>
        </a>

        {% if not job.applied_date %}
        <button class="btn btn-surface btn-small mark-applied-btn" data-job-id="{{ job.id }}" data-company="{{ job.company }}">
            <span>âœ“ Mark applied</span>
        </button>
        {% else %}
        <button class="btn btn-surface btn-small update-status-btn" data-job-id="{{ job.id }}">
            <span>ğŸ“ Update</span>
        </button>
        {% endif %}

        <button class="btn btn-outline btn-small view-cover-letter-btn" 
                data-job-id="{{ job.id }}" 
                data-company="{{ job.company }}" 
                data-title="{{ job.title }}">
            <span>ğŸ“„ Cover Letter</span>
        </button>
    </div>
</div>
